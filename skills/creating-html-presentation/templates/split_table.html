<section data-background="{{ slide.image }}" data-background-opacity="0.5" {% if slide.background_gradient %}
    data-background-gradient="{{ slide.background_gradient }}" {% endif %}>

    <div
        style="display: grid; grid-template-columns: 1fr; gap: 20px; align-items: center; height: 100%; max-width: 1200px; margin: auto; text-align: left;">

        <!-- Fixed min-height ensures consistent vertical centering across paginated slides -->
        <div
            style="padding: 20px; min-height: 60vh; display: flex; flex-direction: column; justify-content: flex-start;">
            {% if slide.badge %}
            <div>
                <h3
                    style="color: #FFD700; margin-bottom: 10px; font-size: 1.2em; border-bottom: 2px solid #FFD700; display: inline-block;">
                    {{ slide.badge }}</h3>
            </div>
            {% endif %}

            <h1 style="font-size: 2.0em; margin-bottom: 20px; line-height: 1.1; text-shadow: 2px 2px 4px black;">{{
                slide.title }}</h1>

            {% if slide.rationale %}
            <div style="font-size: 0.9em; margin-bottom: 20px; color: #eee; font-style: italic; font-weight: 300;">
                <i class="fas fa-lightbulb" style="color: #FFD700; margin-right: 10px;"></i> {{ slide.rationale }}
            </div>
            {% endif %}

            <div style="font-size: 0.9em; line-height: 1.4; flex-grow: 1;">
                {{ slide.content | safe }}
            </div>

            {% if slide.timer %}
            <div
                style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px; text-align: center;">
                <div class="timer-display" id="timer-{{ slide.timer }}-display"
                    style="font-size: 2em; font-family: monospace; color: #FFD700; text-shadow: 0 0 10px rgba(0,0,0,0.8);">
                    {% set mins = (slide.timer / 60) | int %}{% set secs = (slide.timer % 60) | int %}
                    {{ "%02d"|format(mins) }}:{{ "%02d"|format(secs) }}
                </div>
                <div style="margin-top: 5px;">
                    <button class="timer-btn"
                        onclick="toggleTimer({{ slide.timer }}, 'timer-{{ slide.timer }}-display', this)">START</button>
                    <button class="timer-btn reset"
                        onclick="resetTimer({{ slide.timer }}, 'timer-{{ slide.timer }}-display')">RESET</button>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <aside class="notes">
        {{ slide.notes | default('Monitor student progress.') }}
    </aside>
</section>